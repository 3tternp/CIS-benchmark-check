1.1. Disable unused filesystems
1.1.1 Ensure mounting of cramfs filesystems is disabled (Scored)
audit script 
#modprobe -n -v cramfs
install /bin/true
#lsmod | grep cramfs
<no output>

1.1.2 Ensure mounting of freevxfs filesystems is disabled (Scored)
Audit Script 
# modprobe -n -v freevxfs 
install /bin/true
#lsmod | grep freevxfs
<No output>

1.1.3. Ensure mounting of jffs2 filesystems is disabled (Scored)
Audit Script 
# modprobe -n -v jffs2 
install /bin/true 
#lsmod | grep jffs2 
<No output>

1.1.4 Ensure mounting of hfs filesystems is disabled (Scored)
Audit Script
# modprobe -n -v hfs 
install /bin/true 
# lsmod | grep hfs 
<No output>

1.1.5 Ensure mounting of hfsplus filesystems is disabled (Scored)
Audit Script 
# modprobe -n -v hfsplus 
install /bin/true 
# lsmod | grep hfsplus 
<No output>

1.1.6 Ensure mounting of squashfs filesystems is disabled (Scored)
Audit Script 
# modprobe -n -v squashfs 
install /bin/true 
# lsmod | grep squashfs 
<No output>

1.1.7 Ensure mounting of udf filesystems is disabled (Scored)
Audit Script 
# modprobe -n -v udf 
install /bin/true 
# lsmod | grep udf 
<No output>

1.1.8 Ensure mounting of FAT filesystems is disabled (Scored)
Audit Script 
# modprobe -n -v vfat 
install /bin/true 
# lsmod | grep vfat 
<No output>

1.2. Ensure separate partition exists for /tmp (Scored)
Audit Script 
# mount | grep /tmp 
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)

1.3.Ensure nodev option set on /tmp partition (Scored)
Audit Script 
# mount | grep /tmp 
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)

1.4 Ensure nosuid option set on /tmp partition (Scored)
Audit Script 
# mount | grep /tmp 
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)

1.5 Ensure noexec option set on /tmp partition (Scored)
Audit Script 
# mount | grep /tmp 
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)

1.6 Ensure separate partition exists for /var (Scored)
Audit Script 
# mount | grep /var 
/dev/xvdg1 on /var type ext4 (rw,relatime,data=ordered)

1.7 Ensure separate partition exists for /var/tmp (Scored)
Audit Script 
# mount | grep /var/tmp 
<device> on /var/tmp type ext4 (rw,nosuid,nodev,noexec,relatime)

1.8 Ensure nodev option set on /var/tmp partition (Scored)
Audit Script 
# mount | grep /var/tmp 
tmpfs on /var/tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)

1.9 Ensure nosuid option set on /var/tmp partition (Scored)
Audit Script 
# mount | grep /var/tmp 
tmpfs on /var/tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)

1.10 Ensure noexec option set on /var/tmp partition (Scored)
Audit Script 
# mount | grep /var/tmp 
tmpfs on /var/tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)

1.11 Ensure separate partition exists for /var/log (Scored)
Audit Script 
# mount | grep /var/log 
/dev/xvdh1 on /var/log type ext4 (rw,relatime,data=ordered)

1.12 Ensure separate partition exists for /var/log/audit (Scored)
Audit Script 
# mount | grep /var/log/audit 
/dev/xvdi1 on /var/log/audit type ext4 (rw,relatime,data=ordered)

1.13 Ensure separate partition exists for /home (Scored)
Audit Script 
# mount | grep /home 
/dev/xvdf1 on /home type ext4 (rw,nodev,relatime,data=ordered)

1.14 Ensure nodev option set on /home partition (Scored)
Audit Script 
# mount | grep /home 
/dev/xvdf1 on /home type ext4 (rw,nodev,relatime,data=ordered)

1.15 Ensure nodev option set on /dev/shm partition (Scored)
Audit Script 
# mount | grep /dev/shm 
tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,noexec,relatime)

1.16 Ensure nosuid option set on /dev/shm partition (Scored)
Audit Script 
# mount | grep /dev/shm 
tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,noexec,relatime)

1.17 Ensure noexec option set on /dev/shm partition (Scored)
Audit Script 
# mount | grep /dev/shm 
tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,noexec,relatime)

1.18 Ensure nodev option set on removable media partitions (Not Scored)
Audit Script 
#mount 

1.19 Ensure nosuid option set on removable media partitions (Not Scored)
Audit Script 
#mount 

1.20 Ensure noexec option set on removable media partitions (Not Scored)
Audit Script 
# mount

1.21 Ensure sticky bit is set on all world-writable directories (Scored)
Audit Script 
# df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d \( -perm -0002 -a ! -perm -1000 \) 2>/dev/null
<No Output>

1.22 Disable Automounting (Scored)
Audit Script 
# systemctl is-enabled autofs 
disabled

Configure Software Updates
1.2.1 Ensure package manager repositories are configured (Not Scored)
Audit Script 
# yum repolist

1.2.2 Ensure GPG keys are configured (Not Scored)
Audit Script 
# rpm -q gpg-pubkey --qf '%{name}-%{version}-%{release} --> %{summary}\n'

1.2.3 Ensure gpgcheck is globally activated (Scored)
Audit Script 
# grep ^gpgcheck /etc/yum.conf 
gpgcheck=1

Filesystem Integrity Checking
1.3.1 Ensure AIDE is installed (Scored)
Audit Script 
# rpm -q aide 
aide-<version>

1.3.2 Ensure filesystem integrity is regularly checked (Scored)
Audit Script 
# crontab -u root -l | grep aide 
# grep -r aide /etc/cron.* /etc/crontab

Secure Boot Settings

1.4.1 Ensure permissions on bootloader config are configured (Scored)
Audit Script 
# stat /boot/grub2/grub.cfg 
Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root) 
# stat /boot/grub2/user.cfg 
Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

1.4.2 Ensure bootloader password is set (Scored)
Audit Script 
# grep "^GRUB2_PASSWORD" /boot/grub2/grub.cfg 
GRUB2_PASSWORD=<encrypted-password>

1.4.3 Ensure authentication required for single user mode (Scored)
Audit Script 
# grep /sbin/sulogin /usr/lib/systemd/system/rescue.service 
ExecStart=-/bin/sh -c "/sbin/sulogin; /usr/bin/systemctl --fail --no-block default" 
# grep /sbin/sulogin /usr/lib/systemd/system/emergency.service 
ExecStart=-/bin/sh -c "/sbin/sulogin; /usr/bin/systemctl --fail --no-block default"

Additional Process Hardening
1.5.1 Ensure core dumps are restricted (Scored)
Audit Script 
# grep "hard core" /etc/security/limits.conf /etc/security/limits.d/*
* hard core 0
# sysctl fs.suid_dumpable
fs.suid_dumpable = 0 
# grep "fs\.suid_dumpable" /etc/sysctl.conf /etc/sysctl.d/* 
fs.suid_dumpable = 0

1.5.2 Ensure XD/NX support is enabled (Not Scored)
Audit Script 
# dmesg | grep NX 
NX (Execute Disable) protection: active

1.5.3 Ensure address space layout randomization (ASLR) is enabled (Scored)
Audit Script 
# sysctl kernel.randomize_va_space 
kernel.randomize_va_space = 2 
# grep "kernel\.randomize_va_space" /etc/sysctl.conf /etc/sysctl.d/* 
kernel.randomize_va_space = 2

1.5.4 Ensure prelink is disabled (Scored)
Audit Script 
# rpm -q prelink 
package prelink is not installed

Mandatory Access Control
1.6.1 Configure SELinux
1.6.1.1 Ensure SELinux is not disabled in bootloader configuration (Scored)
Audit Script 
# grep "^\s*linux" /boot/grub2/grub.cfg

1.6.1.2 Ensure the SELinux state is enforcing (Scored)
Audit Script 
# grep SELINUX=enforcing /etc/selinux/config
SELINUX=enforcing 
# sestatus
SELinux status: enabled
Current mode: enforcing 
Mode from config file: enforcing


1.6.1.3 Ensure SELinux policy is configured (Scored)
Audit Script 
# grep SELINUXTYPE=targeted /etc/selinux/config
SELINUXTYPE=targeted 
# sestatus 
Loaded policy name: targeted

1.6.1.4 Ensure SETroubleshoot is not installed (Scored)
Audit Script 
# rpm -q setroubleshoot 
package setroubleshoot is not installed

1.6.1.5 Ensure the MCS Translation Service (mcstrans) is not installed (Scored)
Audit Script 
# rpm -q mcstrans 
package mcstrans is not installed

1.6.1.6 Ensure no unconfined daemons exist (Scored)
Audit Script 
# ps -eZ | egrep "initrc" | egrep -vw "tr|ps|egrep|bash|awk" | tr ':' ' ' | 
awk '{ print $NF }'

1.6.2 Ensure SELinux is installed (Scored)
Audit Script 
# rpm -q libselinux 
libselinux-<version>

Warning Banners
1.7.1 Command Line Warning Banners
1.7.1.1 Ensure message of the day is configured properly (Scored)
Audit Script 
# cat /etc/motd
Run the following command and verify no results are returned: 
# egrep '(\\v|\\r|\\m|\\s)' /etc/motd

1.7.1.2 Ensure local login warning banner is configured properly (Not Scored)
Audit Script 
# cat /etc/issue
Run the following command and verify no results are returned: 
# egrep '(\\v|\\r|\\m|\\s)' /etc/issue

1.7.1.3 Ensure remote login warning banner is configured properly (Not Scored)
Audit Script 
# cat /etc/issue.net
Run the following command and verify no results are returned: 
# egrep '(\\v|\\r|\\m|\\s)' /etc/issue.net

1.7.1.4 Ensure permissions on /etc/motd are configured (Not Scored)
Audit Script 
# stat /etc/motd 
Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)

1.7.1.5 Ensure permissions on /etc/issue are configured (Scored)
Audit Script 
# stat /etc/issue 
Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)

1.7.1.6 Ensure permissions on /etc/issue.net are configured (Not Scored)
Audit Script 
# stat /etc/issue.net 
Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)

1.7.2 Ensure GDM login banner is configured (Scored)
Audit Process
If GDM is installed on the system verify that /etc/dconf/profile/gdm exists and contains the following: 
user-db:user 
system-db:gdm 
file-db:/usr/share/gdm/greeter-dconf-defaults
Then verify the banner-message-enable and banner-message-text options are configured in one of the files in the /etc/dconf/db/gdm.d/ directory: 
[org/gnome/login-screen] 
banner-message-enable=true banner-message-text='<banner message>'
This is typically configured in /etc/dconf/db/gdm.d/01-banner-message.

1.8 Ensure updates, patches, and additional security software are installed (Scored)
Audit Script 
# yum check-update --security

Services
2.1 inetd Services
Audit Script 
# chkconfig --list 
xinetd based services: 
             chargen-dgram: off 
             chargen-stream: off

2.1.2 Ensure daytime services are not enabled (Scored)
Audit Script 
# chkconfig --list
 xinetd based services:
              daytime-dgram: off
              daytime-stream: off

2.1.3 Ensure discard services are not enabled (Scored)
Audit Script 
# chkconfig --list 
  xinetd based services: 
                discard-dgram: off
                discard-stream: off

2.1.4 Ensure echo services are not enabled (Scored)
Audit Script 
# chkconfig --list 
  xinetd based services: 
                echo-dgram: off
                echo-stream: off

2.1.5 Ensure time services are not enabled (Scored)
Audit Script 
# chkconfig --list 
 xinetd based services: 
              time-dgram: off 
              time-stream: off

2.1.6 Ensure tftp server is not enabled (Scored)
Audit Script 
# chkconfig --list 
xinetd based services: 
                 tftp: off

2.1.7 Ensure xinetd is not enabled (Scored)
Audit Script 
# systemctl is-enabled xinetd
 disabled

Time Synchronization
2.2.1.1 Ensure time synchronization is in use (Not Scored)
Audit Script
for NTP 
# rpm -q ntp
for Chrony 
# rpm -q chrony

2.2.1.2 Ensure ntp is configured (Scored)
Audit Script 
# grep "^restrict" /etc/ntp.conf 
restrict -4 default kod nomodify notrap nopeer noquery 
restrict -6 default kod nomodify notrap nopeer noquery

# grep "^(server|pool)" /etc/ntp.conf
 server <remote-server>
# grep "^OPTIONS" /etc/sysconfig/ntpd 
OPTIONS="-u ntp:ntp" 
# grep "^ExecStart" /usr/lib/systemd/system/ntpd.service 
ExecStart=/usr/sbin/ntpd -u ntp:ntp $OPTIONS

2.2.1.3 Ensure chrony is configured (Scored)
Audit Script 
# grep "^(server|pool)" /etc/chrony.conf 
server <remote-server>

# grep ^OPTIONS /etc/sysconfig/chronyd 
OPTIONS="-u chrony"

2.2.2 Ensure X Window System is not installed (Scored)
Audit Script 
# rpm -qa xorg-x11*

2.2.3 Ensure Avahi Server is not enabled (Scored)
Audit Script 
# systemctl is-enabled avahi-daemon 
disabled

2.2.4 Ensure CUPS is not enabled (Scored)
Audit Script 
# systemctl is-enabled cups 
disabled

2.2.5 Ensure DHCP Server is not enabled (Scored)
Audit Script 
# systemctl is-enabled dhcpd 
disabled

2.2.6 Ensure LDAP server is not enabled (Scored)
Audit Script 
# systemctl is-enabled slapd 
disabled

2.2.7 Ensure NFS and RPC are not enabled (Scored)
Audit Script 
# systemctl is-enabled nfs 
disabled
# systemctl is-enabled nfs-server 
disabled
# systemctl is-enabled rpcbind 
disabled

2.2.8 Ensure DNS Server is not enabled (Scored)
Audit Script 
# systemctl is-enabled named 
disabled

2.2.9 Ensure FTP Server is not enabled (Scored)
Audit Script 
# systemctl is-enabled vsftpd 
disabled

2.2.10 Ensure HTTP server is not enabled (Scored)(only for web server)
Audit Script 
# systemctl is-enabled httpd 
disabled

2.2.11 Ensure IMAP and POP3 server is not enabled (Scored)
Audit Script 
# systemctl is-enabled dovecot 
disabled

2.2.12 Ensure Samba is not enabled (Scored)
Audit Script 
# systemctl is-enabled smb 
disabled

2.2.13 Ensure HTTP Proxy Server is not enabled (Scored)(for web server http)
Audit Script 
# systemctl is-enabled squid 
disabled

2.2.14 Ensure SNMP Server is not enabled (Scored)
Audit Script 
# systemctl is-enabled snmpd 
disabled

2.2.15 Ensure mail transfer agent is configured for local-only mode (Scored)
Audit Script 
# netstat -an | grep LIST | grep ":25[[:space:]]" 
tcp 0 0 127.0.0.1:25 0.0.0.0:* LISTEN

2.2.16 Ensure NIS Server is not enabled (Scored)
Audit Script 
# systemctl is-enabled ypserv 
disabled

2.2.17 Ensure rsh server is not enabled (Scored)
Audit Script 
# systemctl is-enabled rsh.socket 
disabled

# systemctl is-enabled rlogin.socket 
disabled

# systemctl is-enabled rexec.socket 
disabled

2.2.18 Ensure telnet server is not enabled (Scored)
Audit Script 
# systemctl is-enabled telnet.socket 
disabled
2.2.19 Ensure tftp server is not enabled (Scored)
Audit Script 
# systemctl is-enabled tftp.socket 
disabled

2.2.20 Ensure rsync service is not enabled (Scored)
Audit Script 
# systemctl is-enabled rsyncd 
disabled

2.2.21 Ensure talk server is not enabled (Scored)
Audit Script 
# systemctl is-enabled ntalk 
disabled

Service Clients
2.3.1 Ensure NIS Client is not installed (Scored)
Audit Script 
# rpm -q ypbind 
package ypbind is not installed

2.3.2 Ensure rsh client is not installed (Scored)
Audit Script 
# rpm -q rsh 
package rsh is not installed

2.3.3 Ensure talk client is not installed (Scored)
Audit Script 
# rpm -q talk 
package talk is not installed

2.3.4 Ensure telnet client is not installed (Scored)
Audit Script 
# rpm -q telnet 
package telnet is not installed

2.3.5 Ensure LDAP client is not installed (Scored)
Audit Script 
# rpm -q openldap-clients 
package openldap-clients is not installed

Network Configuration
3.1 Network Parameters (Host Only)
3.1.1 Ensure IP forwarding is disabled (Scored)
Audit Script 
# sysctl net.ipv4.ip_forward 
net.ipv4.ip_forward = 0 
# grep "net\.ipv4\.ip_forward" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.ip_forward = 0

3.1.2 Ensure packet redirect sending is disabled (Scored)
Audit Script 
# sysctl net.ipv4.conf.all.send_redirects 
net.ipv4.conf.all.send_redirects = 0 
# sysctl net.ipv4.conf.default.send_redirects 
net.ipv4.conf.default.send_redirects = 0 
# grep "net\.ipv4\.conf\.all\.send_redirects" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.all.send_redirects = 0 
# grep "net\.ipv4\.conf\.default\.send_redirects" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.default.send_redirects= 0

Network Parameters (Host and Router)
3.2.1 Ensure source routed packets are not accepted (Scored)
Audit Script 
# sysctl net.ipv4.conf.all.accept_source_route 
net.ipv4.conf.all.accept_source_route = 0 
# sysctl net.ipv4.conf.default.accept_source_route 
net.ipv4.conf.default.accept_source_route = 0 
# grep "net\.ipv4\.conf\.all\.accept_source_route" /etc/sysctl.conf/etc/sysctl.d/* 
net.ipv4.conf.all.accept_source_route= 0 
# grep "net\.ipv4\.conf\.default\.accept_source_route" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.default.accept_source_route= 0

3.2.2 Ensure ICMP redirects are not accepted (Scored)
Audit Script 
# sysctl net.ipv4.conf.all.accept_redirects 
net.ipv4.conf.all.accept_redirects = 0 
# sysctl net.ipv4.conf.default.accept_redirects
net.ipv4.conf.default.accept_redirects = 0 
# grep "net\.ipv4\.conf\.all\.accept_redirects" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.all.accept_redirects= 0 
# grep "net\.ipv4\.conf\.default\.accept_redirects" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.default.accept_redirects= 0

3.2.3 Ensure secure ICMP redirects are not accepted (Scored)
Audit Script 
# sysctl net.ipv4.conf.all.secure_redirects 
net.ipv4.conf.all.secure_redirects = 0 
# sysctl net.ipv4.conf.default.secure_redirects 
net.ipv4.conf.default.secure_redirects = 0 
# grep "net\.ipv4\.conf\.all\.secure_redirects" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.all.secure_redirects= 0 
# grep "net\.ipv4\.conf\.default\.secure_redirects" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.default.secure_redirects= 0

3.2.4 Ensure suspicious packets are logged (Scored)
Audit Script 
# sysctl net.ipv4.conf.all.log_martians 
net.ipv4.conf.all.log_martians = 1 
# sysctl net.ipv4.conf.default.log_martians 
net.ipv4.conf.default.log_martians = 1 
# grep "net\.ipv4\.conf\.all\.log_martians" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.all.log_martians = 1 
# grep "net\.ipv4\.conf\.default\.log_martians" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.default.log_martians = 1

3.2.5 Ensure broadcast ICMP requests are ignored (Scored)
Audit Script
# sysctl net.ipv4.icmp_echo_ignore_broadcasts
net.ipv4.icmp_echo_ignore_broadcasts = 1 
# grep "net\.ipv4\.icmp_echo_ignore_broadcasts" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.icmp_echo_ignore_broadcasts = 1

3.2.6 Ensure bogus ICMP responses are ignored (Scored)
Audit Script 
# sysctl net.ipv4.icmp_ignore_bogus_error_responses 
net.ipv4.icmp_ignore_bogus_error_responses = 1 
# grep "net\.ipv4\.icmp_ignore_bogus_error_responses" /etc/sysctl.conf /etc/sysctl.d/*
net.ipv4.icmp_ignore_bogus_error_responses = 1

3.2.7 Ensure Reverse Path Filtering is enabled (Scored)
Audit Script 
# sysctl net.ipv4.conf.all.rp_filter 
net.ipv4.conf.all.rp_filter = 1 
# sysctl net.ipv4.conf.default.rp_filter 
net.ipv4.conf.default.rp_filter = 1 
# grep "net\.ipv4\.conf\.all\.rp_filter" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.all.rp_filter = 1
# grep "net\.ipv4\.conf\.default\.rp_filter" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.conf.default.rp_filter = 1

3.2.8 Ensure TCP SYN Cookies is enabled (Scored)
Audit Script 
# sysctl net.ipv4.tcp_syncookies 
net.ipv4.tcp_syncookies = 1 
# grep "net\.ipv4\.tcp_syncookies" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv4.tcp_syncookies = 1

IPv6
3.3.1 Ensure IPv6 router advertisements are not accepted (Not Scored)
Audit Script 
# sysctl net.ipv6.conf.all.accept_ra 
net.ipv6.conf.all.accept_ra = 0 
# sysctl net.ipv6.conf.default.accept_ra 
net.ipv6.conf.default.accept_ra = 0
# grep "net\.ipv6\.conf\.all\.accept_ra" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv6.conf.all.accept_ra = 0 
# grep "net\.ipv6\.conf\.default\.accept_ra" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv6.conf.default.accept_ra = 0

3.3.2 Ensure IPv6 redirects are not accepted (Not Scored)
Audit Script 
# sysctl net.ipv6.conf.all.accept_redirects 
net.ipv6.conf.all.accept_redirect = 0
# sysctl net.ipv6.conf.default.accept_redirects 
net.ipv6.conf.default.accept_redirect = 0 
# grep "net\.ipv6\.conf\.all\.accept_redirect" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv6.conf.all.accept_redirect = 0
# grep "net\.ipv6\.conf\.default\.accept_redirect" /etc/sysctl.conf /etc/sysctl.d/* 
net.ipv6.conf.default.accept_redirect = 0

3.3.3 Ensure IPv6 is disabled (Not Scored)
Audit Script 
# grep "^\s*linux" /boot/grub2/grub.cfg
ipv6.disable=1

TCP Wrappers
3.4.1 Ensure TCP Wrappers is installed (Scored)
Audit Script 
# rpm -q tcp_wrappers 
tcp_wrappers-<version>

# rpm -q tcp_wrappers-libs 
tcp_wrappers-libs-<version>

3.4.2 Ensure /etc/hosts.allow is configured (Scored)
Audit Script 
# cat /etc/hosts.allow

3.4.3 Ensure /etc/hosts.deny is configured (Scored)
Audit Script 
# cat /etc/hosts.deny 
ALL: ALL

3.4.4 Ensure permissions on /etc/hosts.allow are configured (Scored)
Audit Script 
# stat /etc/hosts.allow 
Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)

3.4.5 Ensure permissions on /etc/hosts.deny are configured (Scored)
Audit Script 
# stat /etc/hosts.deny 
Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)

Uncommon Network Protocols
3.5.1. Ensure DCCP is disabled (Not Scored)
Audit Script 
# modprobe -n -v dccp 
install /bin/true 
# lsmod | grep dccp 
<No output>

3.5.2 Ensure SCTP is disabled (Not Scored)
Audit Script 
# modprobe -n -v sctp 
install /bin/true 
# lsmod | grep sctp 
<No output>

3.5.3 Ensure RDS is disabled (Not Scored)
Audit Script 
# modprobe -n -v rds 
install /bin/true 
# lsmod | grep rds 
<No output>

3.5.4 Ensure TIPC is disabled (Not Scored)
Audit Script 
# modprobe -n -v tipc 
install /bin/true 
# lsmod | grep tipc 
<No output>

Firewall Configuration
Audit Script 
#!/bin/bash 
# Flush IPtables rules 
iptables -F 
# Ensure default deny firewall policy 
iptables -P INPUT DROP 
iptables -P OUTPUT DROP 
iptables -P FORWARD DROP 
# Ensure loopback traffic is configured 
iptables -A INPUT -i lo -j ACCEPT 
iptables -A OUTPUT -o lo -j ACCEPT 
iptables -A INPUT -s 127.0.0.0/8 -j DROP 
# Ensure outbound and established connections are configured 
iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT 
iptables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT 
iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT 
iptables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT 
iptables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT 
iptables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT 
# Open inbound ssh(tcp port 22) connections 
iptables -A INPUT -p tcp --dport 22 -m state --state NEW -j ACCEPT

3.6.1 Ensure iptables is installed (Scored)
Audit Script 
# rpm -q iptables 
iptables-<version>

3.6.2 Ensure default deny firewall policy (Scored)
Audit Script 
# iptables -L 
Chain INPUT (policy DROP) 
Chain FORWARD (policy DROP) 
Chain OUTPUT (policy DROP)

3.6.3 Ensure loopback traffic is configured (Scored)
Audit Script 
# iptables -L INPUT -v -n 
Chain INPUT (policy DROP 0 packets, 0 bytes) 
    pkts bytes target    prot opt in out       source       destination 
      0   0     ACCEPT      all -- lo *         0.0.0.0/0      0.0.0.0/0 
      0   0     DROP        all -- * *          127.0.0.0/8    0.0.0.0/0 

# iptables -L OUTPUT -v -n 
Chain OUTPUT (policy DROP 0 packets, 0 bytes) 
pkts bytes target  prot opt in out  source     destination 
0     0     ACCEPT all -- * lo     0.0.0.0/0     0.0.0.0/0

3.6.4 Ensure outbound and established connections are configured (Not Scored)
Audit Script 
# iptables -L -v -n

3.6.5 Ensure firewall rules exist for all open ports (Scored)
Audit Script
# netstat -ln Active Internet connections (only servers) 
Proto Recv-Q Send-Q Local Address Foreign Address   State 
tcp      0       0   0.0.0.0:22     0.0.0.0:*      LISTEN 

# iptables -L INPUT -v -n 
Chain INPUT (policy DROP 0 packets, 0 bytes)

pkts bytes target  prot opt in out source   destination
 0    0     ACCEPT  all -- lo *   0.0.0.0/0    0.0.0.0/0
 0    0      DROP   all -- * *   127.0.0.0/8   0.0.0.0/0
 0    0     ACCEPT  tcp -- * *   0.0.0.0/0     0.0.0.0/0
tcp dpt:22 state NEW

3.7 Ensure wireless interfaces are disabled (Not Scored)
# iwconfig
# ip link show up

Logging and Auditing
4.1 Configure System Accounting (auditd)
Audit Script 
# service auditd reload
4.1.1 Configure Data Retention
4.1.1.1 Ensure audit log storage size is configured (Not Scored)
# grep max_log_file /etc/audit/auditd.conf 
max_log_file = <MB>

4.1.1.2 Ensure system is disabled when audit logs are full (Scored)
# grep space_left_action /etc/audit/auditd.conf 
space_left_action = email 
# grep action_mail_acct /etc/audit/auditd.conf 
action_mail_acct = root 
# grep admin_space_left_action /etc/audit/auditd.conf 
admin_space_left_action = halt

4.1.1.3 Ensure audit logs are not automatically deleted (Scored)
Audit Script 
# grep max_log_file_action /etc/audit/auditd.conf 
max_log_file_action = keep_logs

4.1.2 Ensure auditd service is enabled (Scored)
Audit Script 
# systemctl is-enabled auditd 
enabled

4.1.3 Ensure auditing for processes that start prior to auditd is enabled (Scored)
Audit Script 
# grep "^\s*linux" /boot/grub2/grub.cfg
audit=1

4.1.4 Ensure events that modify date and time information are collected (Scored)
Audit Script 
On a 32 bit system run the following commands: 
# grep time-change /etc/audit/audit.rules 
# auditctl -l | grep time-change
Verify output of both matches: 
-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change 
-a always,exit -F arch=b32 -S clock_settime -k time-change 
-w /etc/localtime -p wa -k time-change

On a 64 bit system run the following commands: 
# grep time-change /etc/audit/audit.rules 
# auditctl -l | grep time-change
Verify output of both matches:
-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change 
-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change 
-a always,exit -F arch=b64 -S clock_settime -k time-change 
-a always,exit -F arch=b32 -S clock_settime -k time-change 
-w /etc/localtime -p wa -k time-change

4.1.5 Ensure events that modify user/group information are collected (Scored)
Audit Script 
# grep identity /etc/audit/audit.rules 
# auditctl -l | grep identity
Verify output of both matches:
-w /etc/group -p wa -k identity 
-w /etc/passwd -p wa -k identity 
-w /etc/gshadow -p wa -k identity 
-w /etc/shadow -p wa -k identity 
-w /etc/security/opasswd -p wa -k identity

4.1.6 Ensure events that modify the system's network environment are collected (Scored)
Audit Script 
# grep system-locale /etc/audit/audit.rules 
# auditctl -l | grep system-locale

Verify output of both matches:
-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale 
-w /etc/issue -p wa -k system-locale 
-w /etc/issue.net -p wa -k system-locale 
-w /etc/hosts -p wa -k system-locale 
-w /etc/sysconfig/network -p wa -k system-locale 
-w /etc/sysconfig/network-scripts/ -p wa -k system-locale

On a 64 bit system run the following commands: 
# grep system-locale /etc/audit/audit.rules 
# auditctl -l | grep system-locale

Verify output of both matches: 
-a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale 
-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale 
-w /etc/issue -p wa -k system-locale 
-w /etc/issue.net -p wa -k system-locale 
-w /etc/hosts -p wa -k system-locale 
-w /etc/sysconfig/network -p wa -k system-locale 
-w /etc/sysconfig/network-scripts/ -p wa -k system-locale

4.1.7 Ensure events that modify the system's Mandatory Access Controls are collected (Scored)
Audit Script 
# grep MAC-policy /etc/audit/audit.rules 
-w /etc/selinux/ -p wa -k MAC-policy 
-w /usr/share/selinux/ -p wa -k MAC-policy

4.1.8 Ensure login and logout events are collected (Scored)
Audit Script 
# grep logins /etc/audit/audit.rules 
-w /var/log/lastlog -p wa -k logins 
-w /var/run/faillock/ -p wa -k logins

4.1.9 Ensure session initiation information is collected (Scored)
Audit Script 
# grep session /etc/audit/audit.rules 
# auditctl -l | grep session

Verify output of both matches: 
-w /var/run/utmp -p wa -k session
# grep logins /etc/audit/audit.rules 
# auditctl -l | grep logins
Verify output of both matches: 
-w /var/log/wtmp -p wa -k logins 
-w /var/log/btmp -p wa -k logins

4.1.10 Ensure discretionary access control permission modification events are collected (Scored)
On a 32 bit system run the following commands: 
# grep perm_mod /etc/audit/audit.rules 
# auditctl -l | grep perm_mod
Verify output of both matches: 
-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod 
-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod 
-a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod

On a 64 bit system run the following commands:
# grep perm_mod /etc/audit/audit.rules 
# auditctl -l | grep perm_mod
Verify output of both matches: 
-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod 
-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod 
-a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod 
-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod 
-a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod 
-a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod

4.1.11 Ensure unsuccessful unauthorized file access attempts are collected (Scored)
Audit Script 
On a 32 bit system run the following commands: 
# grep access /etc/audit/audit.rules 
# auditctl -l | grep access
Verify output of both matches: 
-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access 
-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access
On a 64 bit system run the following commands: 
# grep access /etc/audit/audit.rules 
# auditctl -l | grep access
Verify output of both matches:
-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access 
-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access 
-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access 
-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access

4.1.12 Ensure use of privileged commands is collected (Scored)
Audit Script 
# find <partition> -xdev \( -perm -4000 -o -perm -2000 \) -type f | awk 
'{print \ 
"-a always,exit -F path=" $1 " -F perm=x -F auid>=1000 -F auid!=4294967295 \ -k privileged" }'

4.1.13 Ensure successful file system mounts are collected (Scored)
Audit Script 
On a 32 bit system run the following commands: 
# grep mounts /etc/audit/audit.rules 
# auditctl -l | grep mounts
Verify output of both matches: 
-a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k mounts
On a 64 bit system run the following commands: 
# grep mounts /etc/audit/audit.rules 
# auditctl -l | grep mounts
Verify output of both matches: 
-a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k mounts 
-a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k mounts

4.1.14 Ensure file deletion events by users are collected (Scored)
Audit Script 
On a 32 bit system run the following commands: 
# grep delete /etc/audit/audit.rules 
# auditctl -l | grep delete
Verify output of both matches: 
-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F auid!=4294967295 -k delete
On a 64 bit system run the following commands: 
# grep delete /etc/audit/audit.rules 
# auditctl -l | grep delete
Verify output of both matches: 
-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F auid!=4294967295 -k delete 
-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F auid!=4294967295 -k delete

4.1.15 Ensure changes to system administration scope (sudoers) is collected (Scored)
Audit Script 
# grep scope /etc/audit/audit.rules 
# auditctl -l | grep scope
-w /etc/sudoers -p wa -k scope 
-w /etc/sudoers.d/ -p wa -k scope

4.1.16 Ensure system administrator actions (sudolog) are collected (Scored)
Audit Script 
# grep actions /etc/audit/audit.rules 
# auditctl -l | grep actions
-w /var/log/sudo.log -p wa -k actions

4.1.17 Ensure kernel module loading and unloading is collected (Scored)
Audit Script
On a 32 bit system run the following commands: 
# grep modules /etc/audit/audit.rules 
# auditctl -l | grep modules
Verify output of both matches: 
-w /sbin/insmod -p x -k modules -w /sbin/rmmod -p x -k modules 
-w /sbin/modprobe -p x -k modules -a always,exit -F arch=b32 -S init_module -S delete_module -k modules
On a 64 bit system run the following commands: 
# grep modules /etc/audit/audit.rules 
# auditctl -l | grep modules
Verify output of both matches: 
-w /sbin/insmod -p x -k modules -w /sbin/rmmod -p x -k modules 
-w /sbin/modprobe -p x -k modules -a always,exit -F arch=b64 -S init_module -S delete_module -k modules

4.1.18 Ensure the audit configuration is immutable (Scored)
Audit Script 
# grep "^\s*[^#]" /etc/audit/audit.rules | tail -1 
-e 2

Configure Logging
4.2.1 Configure rsyslog
4.2.1.1 Ensure rsyslog Service is enabled (Scored)
Audit Script 
# systemctl is-enabled rsyslog 
enabled
4.2.1.2 Ensure logging is configured (Not Scored)
Audit Script 
# ls -l /var/log/

4.2.1.3 Ensure rsyslog default file permissions configured (Scored)
Audit Script 
# grep ^\$FileCreateMode /etc/rsyslog.conf /etc/rsyslog.d/*.conf
$FileCreateMode 0640

4.2.1.4 Ensure rsyslog is configured to send logs to a remote log host (Scored)
Audit Script 
# grep "^*.*[^I][^I]*@" /etc/rsyslog.conf /etc/rsyslog.d/*.conf 
*.* @@loghost.example.com

4.2.1.5 Ensure remote rsyslog messages are only accepted on designated log hosts. (Not Scored)
Audit Script 
# grep '$ModLoad imtcp' /etc/rsyslog.conf /etc/rsyslog.d/*.conf 
$ModLoad imtcp 
# grep '$InputTCPServerRun' /etc/rsyslog.conf /etc/rsyslog.d/*.conf 
$InputTCPServerRun 514

Configure syslog-ng
4.2.2.1 Ensure syslog-ng service is enabled (Scored)
Audit Script 
# systemctl is-enabled syslog-ng 
enabled

4.2.2.2 Ensure logging is configured (Not Scored)
Audit Script 
# ls -l /var/log/
4.2.2.3 Ensure syslog-ng default file permissions configured (Scored)
Audit Script 
# grep ^options /etc/syslog-ng/syslog-ng.conf 
options { chain_hostnames(off); flush_lines(0); perm(0640); stats_freq(3600); 
threaded(yes); };

4.2.2.4 Ensure syslog-ng is configured to send logs to a remote log host (Not Scored)
Audit Script 
destination logserver { tcp("logfile.example.com" port(514)); }; log { source(src); destination(logserver); };

4.2.2.5 Ensure remote syslog-ng messages are only accepted on designated log hosts (Not Scored)
Audit Script 
source net{ tcp(); }; 
destination remote { file("/var/log/remote/${FULLHOST}-log"); }; 
log { source(net); destination(remote); };

4.2.3 Ensure rsyslog or syslog-ng is installed (Scored)
Audit Script 
# rpm -q rsyslog 
# rpm -q syslog-ng

4.2.4 Ensure permissions on all logfiles are configured (Scored)
Audit Script 
# find /var/log -type f -ls

4.3 Ensure logrotate is configured (Not Scored)
Review /etc/logrotate.conf and /etc/logrotate.d/* and verify logs are rotated according to site policy.

Access, Authentication and Authorization
5.1 Configure cron
5.1.1 Ensure cron daemon is enabled (Scored)
Audit Script 
# systemctl is-enabled crond 
enabled

5.1.2 Ensure permissions on /etc/crontab are configured (Scored)
Audit Script 
# stat /etc/crontab 
Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

5.1.3 Ensure permissions on /etc/cron.hourly are configured (Scored)
Audit Script 
# stat /etc/cron.hourly 
Access: (0700/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

5.1.4 Ensure permissions on /etc/cron.daily are configured (Scored)
Audit Script
# stat /etc/cron.daily 
Access: (0700/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

5.1.5 Ensure permissions on /etc/cron.weekly are configured (Scored)
Audit Script 
# stat /etc/cron.weekly 
Access: (0700/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

5.1.6 Ensure permissions on /etc/cron.monthly are configured (Scored)
Audit Script 
# stat /etc/cron.monthly 
Access: (0700/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

5.1.7 Ensure permissions on /etc/cron.d are configured (Scored)
Audit Script 
# stat /etc/cron.d 
Access: (0700/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

5.1.8 Ensure at/cron is restricted to authorized users (Scored)
Audit Script 
# stat /etc/cron.deny 
stat: cannot stat `/etc/cron.deny': No such file or directory 
# stat /etc/at.deny 
stat: cannot stat` /etc/at.deny': No such file or directory

# stat /etc/cron.allow 
Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root) 
# stat /etc/at.allow 
Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

5.2 SSH Server Configuration
Audit Script
# systemctl reload sshd

5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured (Scored)
Audit Script
# stat /etc/ssh/sshd_config 
Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

5.2.2 Ensure SSH Protocol is set to 2 (Scored)
Audit Script 
# grep "^Protocol" /etc/ssh/sshd_config
Protocol 2
5.2.3 Ensure SSH LogLevel is set to INFO (Scored)
Audit Script 
# grep "^LogLevel" /etc/ssh/sshd_config
 LogLevel INFO

5.2.4 Ensure SSH X11 forwarding is disabled (Scored)
Audit Script 
# grep "^X11Forwarding" /etc/ssh/sshd_config 
X11Forwarding no

5.2.5 Ensure SSH MaxAuthTries is set to 4 or less (Scored)
Audit Script 
# grep "^MaxAuthTries" /etc/ssh/sshd_config 
MaxAuthTries 4

5.2.6 Ensure SSH IgnoreRhosts is enabled (Scored)
Audit Script 
# grep "^IgnoreRhosts" /etc/ssh/sshd_config 
IgnoreRhosts yes

5.2.7 Ensure SSH HostbasedAuthentication is disabled (Scored)
Audit Script 
# grep "^HostbasedAuthentication" /etc/ssh/sshd_config 
HostbasedAuthentication no

5.2.8 Ensure SSH root login is disabled (Scored)
Audit Script 
# grep "^PermitRootLogin" /etc/ssh/sshd_config 
PermitRootLogin no

5.2.9 Ensure SSH PermitEmptyPasswords is disabled (Scored)
Audit Script 
# grep "^PermitEmptyPasswords" /etc/ssh/sshd_config 
PermitEmptyPasswords no

5.2.10 Ensure SSH PermitUserEnvironment is disabled (Scored)
Audit Script 
# grep PermitUserEnvironment /etc/ssh/sshd_config 
PermitUserEnvironment no

5.2.11 Ensure only approved MAC algorithms are used (Scored)
Audit Script 
# grep "MACs" /etc/ssh/sshd_config 
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,
hmac-sha2-256,umac-128@openssh.com,curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256

5.2.12 Ensure SSH Idle Timeout Interval is configured (Scored)
Audit Script 
# grep "^ClientAliveInterval" /etc/ssh/sshd_config 
ClientAliveInterval 300 
# grep "^ClientAliveCountMax" /etc/ssh/sshd_config 
ClientAliveCountMax 0

5.2.13 Ensure SSH LoginGraceTime is set to one minute or less (Scored)
Audit Script 
# grep "^LoginGraceTime" /etc/ssh/sshd_config 
LoginGraceTime 60

5.2.14 Ensure SSH access is limited (Scored)
Audit Script 
# grep "^AllowUsers" /etc/ssh/sshd_config 
AllowUsers <userlist> 
# grep "^AllowGroups" /etc/ssh/sshd_config 
AllowGroups <grouplist>
# grep "^DenyUsers" /etc/ssh/sshd_config 
DenyUsers <userlist> 
# grep "^DenyGroups" /etc/ssh/sshd_config 
DenyGroups <grouplist>

5.2.15 Ensure SSH warning banner is configured (Scored)
Audit Script 
# grep "^Banner" /etc/ssh/sshd_config 
Banner /etc/issue.net

Configure PAM
5.3.1 Ensure password creation requirements are configured (Scored)
Audit Script 
# grep pam_pwquality.so /etc/pam.d/password-auth 
password requisite pam_pwquality.so try_first_pass retry=3 
# grep pam_pwquality.so /etc/pam.d/system-auth 
password requisite pam_pwquality.so try_first_pass retry=3 
# grep ^minlen /etc/security/pwquality.conf 
minlen = 14 
# grep ^dcredit /etc/security/pwquality.conf 
dcredit = -1 
# grep ^lcredit /etc/security/pwquality.conf 
lcredit = -1 
# grep ^ocredit /etc/security/pwquality.conf 
ocredit = -1 
# grep ^ucredit /etc/security/pwquality.conf 
ucredit = -1

5.3.2 Ensure lockout for failed password attempts is configured (Scored)
Audit Script 
auth required pam_faillock.so preauth audit silent deny=5 unlock_time=900 
auth [success=1 default=bad] pam_unix.so 
auth [default=die] pam_faillock.so authfail audit deny=5 unlock_time=900 
auth sufficient pam_faillock.so authsucc audit deny=5 unlock_time=900

5.3.3 Ensure password reuse is limited (Scored)
Audit Script 
# egrep '^password\s+sufficient\s+pam_unix.so' /etc/pam.d/password-auth 
password sufficient pam_unix.so remember=5 
# egrep '^password\s+sufficient\s+pam_unix.so' /etc/pam.d/system-auth 
password sufficient pam_unix.so remember=5

or 
# egrep '^password\s+required\s+pam_pwhistory.so' /etc/pam.d/password-auth 
password required pam_pwhistory.so remember=5 
# egrep '^password\s+required\s+pam_pwhistory.so' /etc/pam.d/system-auth 
password required pam_pwhistory.so remember=5

5.3.4 Ensure password hashing algorithm is SHA-512 (Scored)
Audit Script 
# egrep '^password\s+sufficient\s+pam_unix.so' /etc/pam.d/password-auth 
password sufficient pam_unix.so sha512 
# egrep '^password\s+sufficient\s+pam_unix.so' /etc/pam.d/system-auth 
password sufficient pam_unix.so sha512

User Accounts and Environment
5.4.1 Set Shadow Password Suite Parameters
5.4.1.1 Ensure password expiration is 365 days or less (Scored)
Audit Script 
# grep PASS_MAX_DAYS /etc/login.defs 
PASS_MAX_DAYS 90
or 
# egrep ^[^:]+:[^\!*] /etc/shadow | cut -d: -f1 
<list of users> 
# chage --list <user> 
Maximum number of days between password change : 90

5.4.1.2 Ensure minimum days between password changes is 7 or more (Scored)
Audit Script 
# grep PASS_MIN_DAYS /etc/login.defs 
PASS_MIN_DAYS 7
or 
# egrep ^[^:]+:[^\!*] /etc/shadow | cut -d: -f1 
<list of users> 
# chage --list <user> 
Minimum number of days between password change : 7

5.4.1.3 Ensure password expiration warning days is 7 or more (Scored)
Audit Script 
# grep PASS_WARN_AGE /etc/login.defs 
PASS_WARN_AGE 7

or 
# egrep ^[^:]+:[^\!*] /etc/shadow | cut -d: -f1 
<list of users> 
# chage --list <user> 
Number of days of warning before password expires : 7

5.4.1.4 Ensure inactive password lock is 30 days or less (Scored)
Audit Script 
# useradd -D | grep INACTIVE 
INACTIVE=30
or
# egrep ^[^:]+:[^\!*] /etc/shadow | cut -d: -f1 
<list of users> 
# chage --list <user> 
Password inactive: <date>

5.4.1.5 Ensure all users last password change date is in the past (Scored)
Audit Script 
# cat /etc/shadow | cut -d: -f1 
<list of users> 
# chage --list <user> 
Last Change : <date>

5.4.2 Ensure system accounts are non-login (Scored)
Audit Script 
egrep -v "^\+" /etc/passwd | awk -F: '($1!="root" && $1!="sync" && $1!="shutdown" && $1!="halt" && $3<1000 && $7!="/sbin/nologin" && $7!="/bin/false") {print}'

5.4.3 Ensure default group for the root account is GID 0 (Scored)
Audit Script 
# grep "^root:" /etc/passwd | cut -f4 -d: 
0
5.4.4 Ensure default user umask is 027 or more restrictive (Scored)
Audit Script 
# grep "umask" /etc/bashrc 
umask 027 
# grep "umask" /etc/profile /etc/profile.d/*.sh 
umask 027

5.4.5 Ensure default user shell timeout is 900 seconds or less (Scored)
Audit Script 
# grep "^TMOUT" /etc/bashrc 
TMOUT=600 
# grep "^TMOUT" /etc/profile 
TMOUT=600

5.5 Ensure root login is restricted to system console (Not Scored)
Audit Script
# cat /etc/securetty
5.6 Ensure access to the su command is restricted (Scored)
Audit Script 
# grep pam_wheel.so /etc/pam.d/su 
auth required pam_wheel.so use_uid
Run the following command and verify users in wheel group match site policy: 
# grep wheel /etc/group 
wheel:x:10:root,<user list>

System Maintenance
6.1 System File Permissions
6.1.1 Audit system file permissions (Not Scored)
Audit Script 
# rpm -Va --nomtime --nosize --nomd5 --nolinkto > <filename>

6.1.2 Ensure permissions on /etc/passwd are configured (Scored)
Audit Script 
# stat /etc/passwd 
Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)
6.1.3 Ensure permissions on /etc/shadow are configured (Scored)
Audit Script 
# stat /etc/shadow 
Access: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)

6.1.4 Ensure permissions on /etc/group are configured (Scored)
Audit Script 
# stat /etc/group 
Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)

6.1.5 Ensure permissions on /etc/gshadow are configured (Scored)
Audit Script 
# stat /etc/gshadow 
Access: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)

6.1.6 Ensure permissions on /etc/passwd- are configured (Scored)
Audit Script 
# stat /etc/passwd- 
Access: (0644/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

6.1.7 Ensure permissions on /etc/shadow- are configured (Scored)
Audit Script 
# stat /etc/shadow- 
Access: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)

6.1.8 Ensure permissions on /etc/group- are configured (Scored)
Audit Script 
# stat /etc/group- 
Access: (0644/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)

6.1.9 Ensure permissions on /etc/gshadow- are configured (Scored)
Audit Script 
# stat /etc/gshadow- 
Access: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)

6.1.10 Ensure no world writable files exist (Scored)
Audit Script 
# df --local -P | awk {&#039;if (NR!=1) print $6&#039;} | xargs -I &#039;{}&#039; find &#039;{}&#039; -xdev -type f -perm -0002

6.1.11 Ensure no unowned files or directories exist (Scored)
Audit Script 
# df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser

6.1.12 Ensure no ungrouped files or directories exist (Scored)
Audit Script 
# df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nogroup
6.1.13 Audit SUID executables (Not Scored)
Audit Script 
# df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -4000

6.1.14 Audit SGID executables (Not Scored)
Audit Script 
# df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -2000

6.2 User and Group Settings
6.2.1 Ensure password fields are not empty (Scored)
Audit Script 
# cat /etc/shadow | awk -F: '($2 == "" ) { print $1 " does not have a password "}'
6.2.2 Ensure no legacy "+" entries exist in /etc/passwd (Scored)
Audit Script
# grep '^\+:' /etc/passwd
6.2.3 Ensure no legacy "+" entries exist in /etc/shadow (Scored)
Audit Script 
# grep '^\+:' /etc/shadow

6.2.4 Ensure no legacy "+" entries exist in /etc/group (Scored)
Audit Script 
# grep '^\+:' /etc/group

6.2.5 Ensure root is the only UID 0 account (Scored)
Audit Script 
# cat /etc/passwd | awk -F: '($3 == 0) { print $1 }' 
root

6.2.6 Ensure root PATH Integrity (Scored)
Audit Script 
run filecheck.sh 
<no output>
6.2.7 Ensure all users' home directories exist (Scored)
Audit Script 
run noroot.sh
<no output>
6.2.8 Ensure users' home directories permissions are 750 or more restrictive (Scored)
Audit Script 
run permission.sh 
<no output>

6.2.9 Ensure users own their home directories (Scored)
Audit Script 
run home.sh 
<no output>

6.2.10 Ensure users' dot files are not group or world writable (Scored)
Audit Script 
run dotfile.sh 
<no output>

6.2.11 Ensure no users have .forward files (Scored)
Audit Script 
run forward.sh 
<no output>

6.2.12 Ensure no users have .netrc files (Scored)
Audit Script 
run netrc.sh 
<no output>

6.2.13 Ensure users' .netrc Files are not group or world accessible (Scored)
Audit Script 
run netrcgrp.sh 
<no output>

6.2.14 Ensure no users have .rhosts files (Scored)
Audit Script 
run rhosts.sh 
<no result>

6.2.15 Ensure all groups in /etc/passwd exist in /etc/group (Scored)
Audit Script 
run group.sh
<no result>
6.2.16 Ensure no duplicate UIDs exist (Scored)
Audit Script 
run duplicate.sh 
<no result>
6.2.17 Ensure no duplicate GIDs exist (Scored)
Audit Script 
run duplicategid.sh
<no result>

6.2.18 Ensure no duplicate user names exist (Scored)
Audit Script
run duplicateuser.sh
<no result>

6.2.19 Ensure no duplicate group names exist (Scored)
Audit Script
run duplicategroup.sh 
<no result>


